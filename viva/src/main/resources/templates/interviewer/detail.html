<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>면접관 상세</title>
  <link rel="stylesheet" th:href="@{/css/interviewer.css}">
</head>
<body>

<div class="detail-container">
  <div class="interviewer-profile">
    <img th:src="@{${interviewer.intrImage}}" alt="프로필 이미지" class="profile-img" />
    <div class="info-box">
      <p><strong>이름:</strong> <span th:text="${interviewer.userName}"></span></p>
      <p><strong>경력:</strong> <span th:text="${interviewer.userCareer}"></span></p>
      <p><strong>직무:</strong> <span th:text="${interviewer.intrCate}"></span></p>
      <p><strong>보유 스킬:</strong> <span th:text="${interviewer.userSkill}"></span></p>
      <p><strong>상담 가격:</strong> <span th:text="${interviewer.intrPrice}">0</span> 원</p>
    </div>
  </div>

  <!-- ✅ 자기소개 영역 -->
  <div class="detail-content-section">
    <h3>자기소개</h3>
    <div class="detail-content-box">
      <p th:text="${interviewer.intrContent}">
        상담 방식, 강점, 이력 등을 작성해주세요.
      </p>
    </div>
  </div>

  <!-- ✅ 후기 섹션 -->
  <hr>
  <div class="review-section">
    <h3>후기</h3>
    <!-- 리뷰 등록 폼 -->
    <form th:action="@{'/interviewer/' + ${interviewer.intrId} + '/review'}" method="post" style="margin-bottom: 30px;">
      <label>별점:
        <select name="score" required>
          <option value="5">5.0</option>
          <option value="4.5">4.5</option>
          <option value="4">4.0</option>
          <option value="3.5">3.5</option>
          <option value="3">3.0</option>
          <option value="2.5">2.5</option>
          <option value="2">2.0</option>
          <option value="1.5">1.5</option>
          <option value="1">1.0</option>
        </select>
      </label>
      <label>내용:
        <input type="text" name="content" maxlength="300" required style="width: 300px;">
      </label>
      <button type="submit">등록</button>
    </form>
    <!-- 리뷰 목록 -->
    <div th:each="r : ${reviews}">
      <div class="review-card">
        <p><strong th:text="${r.userId}">작성자</strong> | <span th:text="${#temporals.format(r.createdDt, 'yyyy-MM-dd HH:mm')}">날짜</span></p>
        <p th:text="${r.content}">후기 내용</p>
        <p>⭐ <span th:text="${r.score}">5.0</span></p>
        <!-- 본인 리뷰에만 수정/삭제 버튼 노출 (예시: principal.name == r.userId) -->
        <div th:if="${#authentication != null and #authentication.name == r.userId}">
          <!-- 수정 폼 (간단하게 inline form) -->
          <form th:action="@{'/interviewer/' + ${interviewer.intrId} + '/review/' + ${r.reviewNo} + '/edit'}" method="post" style="display:inline;">
            <select name="score" required>
              <option th:selected="${r.score == 5}" value="5">5.0</option>
              <option th:selected="${r.score == 4.5}" value="4.5">4.5</option>
              <option th:selected="${r.score == 4}" value="4">4.0</option>
              <option th:selected="${r.score == 3.5}" value="3.5">3.5</option>
              <option th:selected="${r.score == 3}" value="3">3.0</option>
              <option th:selected="${r.score == 2.5}" value="2.5">2.5</option>
              <option th:selected="${r.score == 2}" value="2">2.0</option>
              <option th:selected="${r.score == 1.5}" value="1.5">1.5</option>
              <option th:selected="${r.score == 1}" value="1">1.0</option>
            </select>
            <input type="text" name="content" th:value="${r.content}" maxlength="300" required style="width: 200px;">
            <button type="submit">수정</button>
          </form>
          <!-- 삭제 버튼 -->
          <form th:action="@{'/interviewer/' + ${interviewer.intrId} + '/review/' + ${r.reviewNo} + '/delete'}" method="post" style="display:inline;">
            <button type="submit" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
