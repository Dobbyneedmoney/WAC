<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:replace="${title}">VIVA</title>
<link rel="stylesheet" th:href="@{/css/common.css}">

</head>
<body>
<script src="/js/session-timer.js"></script>
	<div th:fragment="headerFragment">
		<!-- Header -->
		<header>
			<div class="logo">
				<a th:href="@{/main}" style="color: inherit; text-decoration: none;">VIVA</a>
			</div>
			<nav>
				<a th:href="@{/about}">About</a> 
				<a th:href="@{/ai/aichat}">AI</a> 
				<a th:href="@{/interviewer}">Interviewr</a> 
				<a th:href="@{/board/list}">Board</a>
				<a th:href="@{/reviewboard/list}">Review</a>

				<!-- 관리자 모드 -->
				<span th:if="${session.role == 'admin'}"> Welcome, <span
					th:text="${session.displayName}"
					style="font-weight: bold; color: #cc0000;"></span> 님! <a
					th:href="@{/admin/dashboard}"
					style="margin-left: 14px; font-weight: bold;">대시보드</a>
				</span>

				<!-- 면접관/취준생 -->
				<span th:if="${session.displayName != null}"> 
					<a th:if="${session.role == 'intr'}" th:href="@{/mypage}"> 
						<span th:text="'Welcome, ' + ${session.displayName} + '님!'"></span>
					</a> 
					<a th:if="${session.role == 'mem'}" th:href="@{/mypage}"> 
						<span th:text="'Welcome, ' + ${session.displayName} + '님!'"></span>
					</a> 
					<a th:href="@{/logout}" style="margin-left: 10px;">Logout</a>
				</span> 
				<span th:unless="${session.displayName != null}"> 
					<a th:href="@{/loginmain}">Longin</a>
				</span>

				<span style="margin-left: 25px; color: #666; font-size: 0.92em;">
				    남은 시간: <span id="session-timer"></span>
				</span>

<!-- 세션 유지 시간 60분 -->
<script th:inline="javascript">
/*<![CDATA[*/
    var loginTime = Number('[[${session.loginTime}]]');
	var timeoutSec = Number('[[${sessionTimeout} * 60]]');
    function updateSessionTimer() {
        var now = new Date().getTime();
        var remainSec = Math.max(0, Math.floor((loginTime + timeoutSec * 1000 - now) / 1000));
        var mm = String(Math.floor(remainSec / 60)).padStart(2, '0');
        var ss = String(remainSec % 60).padStart(2, '0');
        document.getElementById('session-timer').textContent = mm + ":" + ss;
    }
    if(loginTime && timeoutSec){
        updateSessionTimer();
        setInterval(updateSessionTimer, 1000);
    } else {
        document.getElementById('session-timer').textContent = "정보없음";
    }
/*]]>*/
</script>

				<!-- <span th:if="${displayName != null}">
        <a th:if="${role == 'intr'}" th:href="@{/mypage}" style="text-decoration:none; color:inherit; font-weight:bold;">
            <span th:text="'환영합니다, ' + ${displayName} + '님!'"></span>
        </a>
        <a th:if="${role == 'mem'}" th:href="@{/mypage}" style="text-decoration:none; color:inherit; font-weight:bold;">
            <span th:text="'환영합니다, ' + ${displayName} + '님!'"></span>
        </a>
        <a th:href="@{/logout}" style="margin-left: 10px;">로그아웃</a>
      </span>
      <span th:unless="${displayName != null}">
        <a th:href="@{/loginmain}">로그인</a>
      </span> -->
			</nav>
		</header>
	</div>

</body>
</html>